<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8" />
		<title>Key test</title>
		<style>
            body
            {
                background-color: #000;
            }
		</style>
        <script>
            //Main OL with frames.
            var main =
            {
                init : function()
                {
                    this.frame();
                },
                
                frame : function()
                {
                    this.animationID = requestAnimationFrame(this.frame.bind(this));
                    
                    //Test up arrow key
                    console.log(keys.isUp[38]);
                        
                    keys.refresh();
                }
            };
            
            //OL with key arrays and methods.
            var keys =
            {
                //Array of key states
                //0 == up
                //1 == pressed
                //2 == down
                //3 == released
                state : [],
                
                //Refreshes pressed and released states to down and up
                refresh : function()
                {
                    for(var i = 0; i < this.state.length; i++)
                    {
                        if(this.state[i] == 1)   //Pressed to down
                            this.state[i] = 2;
                        if(this.state[i] == 3)   //Released to up
                            this.state[i] = 0;
                    }
                },
                
                //key state queries
                isUp : function(key)
                {
                    return !keys[key];
                },
                
                isPressed : function(key)
                {
                    return keys[key] == 1;
                },
                
                isDown : function(key)
                {
                    return keys[key] == 2;
                },
                
                isReleased : function(key)
                {
                    return keys[key] == 3;
                },
            };
            
            //Set that key is down to keys
            window.addEventListener(
                "keydown",
                function(e)
                {
                    if(!keys.state[e.keyCode])
                        keys.state[e.keyCode] = 1;
                });
            
            //Set that key is up to keys
            window.addEventListener(
                "keyup",
                function(e)
                {
                    keys.state[e.keyCode] = 3;
                });
            
            //Start animation
            window.onload = function()
            {
                main.init();
            };
        </script>
	</head>
	<body>
	</body>
</html>
