<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8" />
		<title>Key test</title>
		<style>
            body
            {
                background-color: #000;
            }
		</style>
        <script>
            //Main OL with frames.
            var main =
            {
                init : function()
                {
                    this.frame();
                },
                
                frame : function()
                {
                    this.animationID = requestAnimationFrame(this.frame.bind(this));
                    
                    for(i in keys.REFERENCE)
                    {
                        if(keys.isPressed(i))
                            console.log(keys.REFERENCE[i]);
                    }
                        
                    keys.refresh();
                }
            };
            
            //OL with key arrays and methods.
            var keys =
            {
                //Array of key states
                //0 == up
                //1 == pressed
                //2 == down
                //3 == released
                state : [],
                
                KEYBOARD : Object.freeze
                ({
                    "BACKSPACE" : 8,
                    "TAB" : 9,
                    "ENTER" : 13,
                    "SHIFT" : 16,
                    "CTRL" : 17,
                    "ALT" : 18,
                    "PAUSE" : 19,
                    "CAPS" : 20,
                    "ESC" : 27,
                    "SPACE" : 32,
                    
                    "PAGEUP" : 33,
                    "PAGEDOWN" : 34,
                    "END" : 35,
                    "HOME" : 36,
                    "INSERT" : 45,
                    "DELETE" : 46,
                    
                    "LEFT" : 37, 
                    "UP" : 38, 
                    "RIGHT" : 39, 
                    "DOWN" : 40,
                    
                    "0" : 48,
                    "1" : 49,
                    "2" : 50,
                    "3" : 51,
                    "4" : 52,
                    "5" : 53,
                    "6" : 54,
                    "7" : 55,
                    "8" : 56,
                    "9" : 57,
                    
                    "A" : 65,
                    "B" : 66,
                    "C" : 67,
                    "D" : 68,
                    "E" : 69,
                    "F" : 70,
                    "G" : 71,
                    "H" : 72,
                    "I" : 73,
                    "J" : 74,
                    "K" : 75,
                    "L" : 76,
                    "M" : 77,
                    "N" : 78,
                    "O" : 79,
                    "P" : 80,
                    "Q" : 81,
                    "R" : 82,
                    "S" : 83,
                    "T" : 84,
                    "U" : 85,
                    "V" : 86,
                    "W" : 87,
                    "X" : 88,
                    "Y" : 89,
                    "Z" : 90,
                    
                    "NUM0" : 96,
                    "NUM1" : 97,
                    "NUM2" : 98,
                    "NUM3" : 99,
                    "NUM4" : 100,
                    "NUM5" : 101,
                    "NUM6" : 102,
                    "NUM7" : 103,
                    "NUM8" : 104,
                    "NUM9" : 105,
                    
                    "ADD" : 107,
                    "SUB" : 109,
                    "MULT" : 106,
                    "DIV" : 111,
                    "DEC" : 110,
                    
                    "F1" : 112,
                    "F2" : 113,
                    "F3" : 114,
                    "F4" : 115,
                    "F5" : 116,
                    "F6" : 117,
                    "F7" : 118,
                    "F8" : 119,
                    "F9" : 120,
                    "F10" : 121,
                    "F11" : 122,
                    "F12" : 123,
                    
                    "NUMLOCK" : 144,
                    "SCROLLLOCK" : 145,
                    "SEMICOLON" : 186,
                    "EQUAL" : 187,
                    "COMMA" : 188,
                    "DASH" : 189,
                    "PERIOD" : 190,
                    "FORWARDSLASH" : 191,
                    "BACKSLASH" : 220,
                    "TILDE" : 192,
                    "OPENBRACKET" : 219,
                    "CLOSEBRACKET" : 221,
                    "QUOTE" : 222
                }),
                
                REFERENCE : Object.freeze
                ({
                    8 : "BACKSPACE",
                    9 : "TAB",
                    13 : "ENTER",
                    16 : "SHIFT",
                    17 : "CTRL",
                    18 : "ALT",
                    19 : "PAUSE",
                    20 : "CAPS",
                    27 : "ESC",
                    32 : "SPACE",
                    
                    33 : "PAGEUP",
                    34 : "PAGEDOWN",
                    35 : "END",
                    36 : "HOME",
                    45 : "INSERT",
                    46 : "DELETE",
                    
                    37 : "LEFT", 
                    38 : "UP", 
                    39 : "RIGHT", 
                    40 : "DOWN",
                    
                    48 : "0",
                    49 : "1",
                    50 : "2",
                    51 : "3",
                    52 : "4",
                    53 : "5",
                    54 : "6",
                    55 : "7",
                    56 : "8",
                    57 : "9",
                    
                    65 : "A",
                    66 : "B",
                    67 : "C",
                    68 : "D",
                    69 : "E",
                    70 : "F",
                    71 : "G",
                    72 : "H",
                    73 : "I",
                    74 : "J",
                    75 : "K",
                    76 : "L",
                    77 : "M",
                    78 : "N",
                    79 : "O",
                    80 : "P",
                    81 : "Q",
                    82 : "R",
                    83 : "S",
                    84 : "T",
                    85 : "U",
                    86 : "V",
                    87 : "W",
                    88 : "X",
                    89 : "Y",
                    90 : "Z",
                    
                    96 : "NUM0",
                    97 : "NUM1",
                    98 : "NUM2",
                    99 : "NUM3",
                    100 : "NUM4",
                    101 : "NUM5",
                    102 : "NUM6",
                    103 : "NUM7",
                    104 : "NUM8",
                    105 : "NUM9",
                    
                    107 : "ADD",
                    109 : "SUB",
                    106 : "MULT",
                    111 : "DIV",
                    110 : "DEC",
                    
                    112 : "F1",
                    113 : "F2",
                    114 : "F3",
                    115 : "F4",
                    116 : "F5",
                    117 : "F6",
                    118 : "F7",
                    119 : "F8",
                    120 : "F9",
                    121 : "F10",
                    122 : "F11",
                    123 : "F12",
                    
                    144 : "NUMLOCK",
                    145 : "SCROLLLOCK",
                    186 : "SEMICOLON",
                    187 : "EQUAL",
                    188 : "COMMA",
                    189 : "DASH",
                    190 : "PERIOD",
                    191 : "FORWARDSLASH",
                    220 : "BACKSLASH",
                    192 : "TILDE",
                    219 : "OPENBRACKET",
                    221 : "CLOSEBRACKET",
                    222 : "QUOTE"
                }),
                
                //Refreshes pressed and released states to down and up
                refresh : function()
                {
                    for(var i = 0; i < this.state.length; i++)
                    {
                        if(this.state[i] == 1)   //Pressed to down
                            this.state[i] = 2;
                        if(this.state[i] == 3)   //Released to up
                            this.state[i] = 0;
                    }
                },
                
                //key state queries
                isUp : function(key)
                {
                    return !keys.state[key];
                },
                
                isPressed : function(key)
                {
                    return keys.state[key] == 1;
                },
                
                isDown : function(key)
                {
                    return keys.state[key] == 2;
                },
                
                isReleased : function(key)
                {
                    return keys.state[key] == 3;
                },
            };
            
            //Set that key is down to keys
            window.addEventListener(
                "keydown",
                function(e)
                {
                    if(!keys.state[e.keyCode])
                        keys.state[e.keyCode] = 1;
                });
            
            //Set that key is up to keys
            window.addEventListener(
                "keyup",
                function(e)
                {
                    keys.state[e.keyCode] = 3;
                });
            
            //Start animation
            window.onload = function()
            {
                main.init();
            };
        </script>
	</head>
	<body>
	</body>
</html>
